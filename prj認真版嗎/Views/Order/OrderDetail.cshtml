@model List<COrederDetailsViewModel>
@using prj認真版嗎.ViewModel
<link href="~/css/JianOrderList.css" rel="stylesheet" />
@{
    Layout = null;

}
<div>
    <table class="table">
        <thead>
            <tr class="thbkc">
                <th>

                </th>
                <th>
                    @Html.DisplayNameFor(model => model.FirstOrDefault().產品名稱)
                </th>
                <th>
                    @Html.DisplayNameFor(model => model.FirstOrDefault().Quantity)
                </th>
                <th>
                    @Html.DisplayNameFor(model => model.FirstOrDefault().UnitPrice)
                </th>
                <th>
                    @Html.DisplayNameFor(model => model.FirstOrDefault().優惠券名稱)
                </th>
                <th>
                    @Html.DisplayNameFor(model => model.FirstOrDefault().優惠內容)
                </th>
                <th>
                    小計
                </th>
            </tr>
        </thead>
        <tbody>
            @{
                int count = 0;
                decimal 總金額 = 0;
                decimal 總小計 = 0;
                decimal 手續費 = 0;
                foreach (var item in Model)
                {
                    count++;
                    string 優惠內容 = "";
                    decimal 小計 = 0;
                    if (item.優惠內容 > 1 && item.優惠內容 != null)
                    {
                        優惠內容 = "折抵金額:" + item.優惠內容;
                        小計 = item.小計 - (decimal)item.優惠內容;
                        總小計 += 小計;
                    }
                    else if (item.優惠內容 < 1 && item.優惠內容 != null)
                    {
                        優惠內容 = ((decimal)item.優惠內容 * 10).ToString("###,#0") + "折";
                        小計 = item.小計 * (decimal)item.優惠內容;
                        總小計 += 小計;
                    }
                    else if(item.優惠內容==null) {
                        優惠內容 = "無使用優惠券";
                        小計 = item.小計;
                        總小計 += 小計;
                    }
                    <tr class="trtd">
                        <td>
                            @count .
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.產品名稱)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.Quantity)
                        </td>
                        <td>
                            @item.UnitPrice.ToString("###,##0")
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.優惠券名稱)
                        </td>
                        <td>
                            @優惠內容
                        </td>
                        <td>
                            @小計.ToString("###,#0")
                        </td>
                    </tr>
                }

                //稅金 = 總小計 * 0.05M;
                總金額 = 手續費 + 總小計;
            }
        <tr>
            <td>
            </td>
            <td>
            </td>
            <td>
            </td>
            <td>
            </td>
            <td colspan="2">
            </td>
            <td class="金額顯示">
                <p>小計金額: @總小計.ToString("###,###,##0")</p>
                <p>手&ensp;續&ensp;費: @手續費.ToString("###,###,##0")</p>
                <p>總&ensp;金&ensp;額: @總金額.ToString("###,###,##0")</p>
            </td>
            <td></td>
        </tr>
        </tbody>
    </table>
</div>
<div class="d-flex justify-content-center">
    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" style="right:0">關閉</button>
</div>
